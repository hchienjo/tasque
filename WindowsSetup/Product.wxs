<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="*" Name="Tasque" Language="1033" Version="0.1.12" Manufacturer="Tasque Project" UpgradeCode="d4720f75-fd29-4014-9fbe-bd5a6473c48f">
		<Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate />

    <!--
			The install directory will be stored in the registry 
			this way, future "upgrades" can auto-detect where to go
			TODO: HKLM access requires elevation on Vista, but so do
				"Program Files" installs. If we want non-elevated users
				to be able to install this as smoothly (outside of the
				"Program Files" folder), we need to fall back to HKCU?
		-->
    <Property Id="INSTALLFOLDER">
      <RegistrySearch Id='SearchTasqueInstallFolder' Type='directory' Root='HKLM' Key='Software\Tasque' Name='InstallFolder' />
    </Property>

    <Feature Id="TasqueFeature" Title="Tasque" Level="1">
      <ComponentGroupRef Id="TasqueComponents" />
      <ComponentGroupRef Id="TasqueResources" />
      <ComponentGroupRef Id="TasqueLocales" />
    </Feature>
  </Product>
  
  <Fragment>
    <ComponentGroup Id="TasqueComponents" Directory="INSTALLFOLDER">
      <Component Id="TasqueCore" Guid="9243C6FE-AE86-4F7B-B446-CB4D01993D6A">
        <File Source="..\build\bin\lib\tasque\Tasque.exe" />
        <File Source="..\build\bin\lib\tasque\libtasque.dll" />
        <File Source="..\build\bin\lib\tasque\Gtk.Tasque.dll" />
      </Component>
      <Component Id="RtmBackend" Guid="A7B0E0A4-0819-46AF-AD95-BC4D987B7AD2">
        <File Source="..\build\bin\lib\tasque\RtmBackend.dll" />
        <File Source="..\build\bin\lib\tasque\RtmNet.dll" />
      </Component>
      <Component Id="SqliteBackend" Guid="78130250-7C68-4A44-B4AA-9209C2C6BD2C">
        <File Source="..\build\bin\lib\tasque\SqliteBackend.dll" />
        <File Source="..\build\bin\lib\tasque\Mono.Data.Sqlite.dll" />
        <File Source="..\build\bin\lib\tasque\sqlite3.dll" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>